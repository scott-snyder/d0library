      FUNCTION STRUC(X,QSQ,IQ,IH)   
C          COMPUTE STRUCTURE FUNCTIONS X*F(X,QSQ)   
C          ISTRUC=3 FOR EICHTEN, HINCHLIFFE, LANE, AND QUIGG (1984) 
C                   SOLUTION 1  
C          ISTRUC=4 DUKE AND OWENS, PHYS. REV. D30, 49. 
C                   SOLUTION 1  
C          QUARK TYPES--    
C          IQ=1  2  3  4  5  6  7  8  9  10 11 12 13    
C             GL UP UB DN DB ST SB CH CB BT BB TP TB    
C          HADRON TYPES--   
C          IH=+1120  -1120  +1220  -1220    
C                 P     AP      N     AN    
C   
C          FOR IBM COMPATIBILITY REQUIRE STRUC > SFMIN = 1.E-10 
      COMMON/ITAPES/ITDKY,ITEVT,ITCOM,ITLIS 
      INTEGER   ITDKY,ITEVT,ITCOM,ITLIS 
      COMMON/QCDPAR/ALAM,ALAM2,CUTJET,ISTRUC    
      INTEGER   ISTRUC  
      REAL      ALAM,ALAM2,CUTJET   
C          E1STRC CONTAINS ALL THE COEFFICIENTS FOR EICHTEN, ETAL,  
C          SOLUTION 1. IT IS EQUIVALENCED TO ARRAYS FOR THE 16 SETS OF  
C          COEFFICIENTS.    
      DIMENSION E1STRC(6,6,16),E1POW(8),IE1FIT(13)  
      DIMENSION E1UPHI(6,6),E1DNHI(6,6),E1UBHI(6,6),E1GLHI(6,6),    
     $E1STHI(6,6),E1CHHI(6,6),E1BTHI(6,6),E1TPHI(6,6)   
      DIMENSION E1UPLO(6,6),E1DNLO(6,6),E1UBLO(6,6),E1GLLO(6,6),    
     $E1STLO(6,6),E1CHLO(6,6),E1BTLO(6,6),E1TPLO(6,6)   
      EQUIVALENCE (E1UPHI(1,1),E1STRC(1,1,1))   
      EQUIVALENCE (E1DNHI(1,1),E1STRC(1,1,2))   
      EQUIVALENCE (E1UBHI(1,1),E1STRC(1,1,3))   
      EQUIVALENCE (E1GLHI(1,1),E1STRC(1,1,4))   
      EQUIVALENCE (E1STHI(1,1),E1STRC(1,1,5))   
      EQUIVALENCE (E1CHHI(1,1),E1STRC(1,1,6))   
      EQUIVALENCE (E1BTHI(1,1),E1STRC(1,1,7))   
      EQUIVALENCE (E1TPHI(1,1),E1STRC(1,1,8))   
      EQUIVALENCE (E1UPLO(1,1),E1STRC(1,1,9))   
      EQUIVALENCE (E1DNLO(1,1),E1STRC(1,1,10))  
      EQUIVALENCE (E1UBLO(1,1),E1STRC(1,1,11))  
      EQUIVALENCE (E1GLLO(1,1),E1STRC(1,1,12))  
      EQUIVALENCE (E1STLO(1,1),E1STRC(1,1,13))  
      EQUIVALENCE (E1CHLO(1,1),E1STRC(1,1,14))  
      EQUIVALENCE (E1BTLO(1,1),E1STRC(1,1,15))  
      EQUIVALENCE (E1TPLO(1,1),E1STRC(1,1,16))  
      DIMENSION CHEBX(6),CHEBQ(6)   
C          EICHTEN ETAL SOLUTION 1 CONSTANTS    
C          CORRECTED COEFFICIENTS FROM IAN HINCHLIFFE, 3 JUNE 1986. 
      DATA E1UPHI/  
     $  0.76772, -0.20874, -0.33026, -0.02517, -0.01570, -0.00010,  
     $ -0.53259, -0.26612,  0.32007,  0.11918,  0.02434,  0.00762,  
     $  0.21618,  0.18812, -0.08375, -0.06515, -0.01743, -0.00504,  
     $ -0.09211, -0.09952,  0.01373,  0.02506,  0.00877,  0.00255,  
     $  0.03670,  0.04409,  0.00096, -0.00796, -0.00342, -0.00105,  
     $ -0.01549, -0.02026, -0.00306,  0.00222,  0.00124,  0.00041/  
      DATA E1DNHI/  
     $  0.38130, -0.08090, -0.16336, -0.02185, -0.00843, -0.00062,  
     $ -0.29475, -0.14348,  0.16650,  0.06638,  0.01473,  0.00408,  
     $  0.12518,  0.10422, -0.04722, -0.03683, -0.01038, -0.00286,  
     $ -0.05478, -0.05678,  0.00890,  0.01484,  0.00534,  0.00152,  
     $  0.02220,  0.02567, -0.00003, -0.00497, -0.00216, -0.00065,  
     $ -0.00953, -0.01204, -0.00151,  0.00151,  0.00083,  0.00027/  
      DATA E1UBHI/  
     $  0.06870, -0.06861,  0.02973, -0.00540,  0.00378, -0.00097,  
     $ -0.01802,  0.00014,  0.00649, -0.00854,  0.00122, -0.00175,  
     $ -0.00465,  0.00148, -0.00593,  0.00060, -0.00103, -0.00008,  
     $  0.00644,  0.00257,  0.00283,  0.00115,  0.00071,  0.00033,  
     $ -0.00393, -0.00254, -0.00116, -0.00077, -0.00036, -0.00019,  
     $  0.00234,  0.00193,  0.00053,  0.00037,  0.00016,  0.00009/  
      DATA E1GLHI/  
     $  0.94819, -0.95779,  0.10085, -0.10510,  0.03456, -0.03054,  
     $ -0.96265,  0.53790,  0.33684, -0.09525,  0.01488, -0.02051,  
     $  0.43004, -0.08306, -0.33719,  0.04902, -0.00916,  0.01041,  
     $ -0.19249, -0.01790,  0.21830,  0.00749,  0.00414, -0.00186,  
     $  0.08183,  0.01926, -0.10718, -0.01944, -0.00277, -0.00052,  
     $ -0.03884, -0.01234,  0.05410,  0.01879,  0.00335,  0.00104/  
      DATA E1STHI/  
     $  0.04968, -0.04173,  0.02102, -0.00327,  0.00324, -0.00067,  
     $ -0.00615, -0.01294,  0.00674, -0.00689,  0.00090, -0.00151,  
     $ -0.00858,  0.00505, -0.00490, -0.00016, -0.00094, -0.00015,  
     $  0.00784,  0.00151,  0.00222,  0.00140,  0.00070,  0.00035,  
     $ -0.00441, -0.00222, -0.00089, -0.00085, -0.00036, -0.00020,  
     $  0.00252,  0.00184,  0.00041,  0.00039,  0.00016,  0.00009/  
      DATA E1CHHI/  
     $  0.00927, -0.01817,  0.00959, -0.00639,  0.00169, -0.00154,  
     $  0.00571, -0.01188,  0.00609, -0.00465,  0.00124, -0.00131,  
     $ -0.00396,  0.00710, -0.00359,  0.00184, -0.00039,  0.00034,  
     $  0.00112, -0.00196,  0.00112, -0.00048,  0.00010, -0.00004,  
     $  0.00004, -0.00003, -0.00018,  0.00009, -0.00005, -0.00002,  
     $ -0.00042,  0.00073, -0.00016,  0.00005,  0.00005,  0.00005/  
      DATA E1BTHI/  
     $  0.00901, -0.01401,  0.00715, -0.00413,  0.00126, -0.00104,  
     $  0.00628, -0.00932,  0.00478, -0.00289,  0.00091, -0.00082,  
     $ -0.00293,  0.00409, -0.00189,  0.00076, -0.00023,  0.00014,  
     $  0.00039, -0.00120,  0.00044, -0.00025,  0.00002, -0.00002,  
     $  0.00026,  0.00014, -0.00008,  0.00010,  0.00001,  0.00001,  
     $ -0.00026,  0.00032,  0.00001, -0.00001,  0.00001, -0.00001/  
      DATA E1TPHI/  
     $  0.00441, -0.00748,  0.00377, -0.00258,  0.00073, -0.00071,  
     $  0.00384, -0.00605,  0.00303, -0.00203,  0.00058, -0.00059,  
     $ -0.00088,  0.00166, -0.00075,  0.00047, -0.00010,  0.00010,  
     $ -0.00008, -0.00015,  0.00012, -0.00009,  0.00003,  0.00000,  
     $  0.00013, -0.00022, -0.00002, -0.00002, -0.00002, -0.00002,  
     $ -0.00007,  0.00019, -0.00004,  0.00002,  0.00000,  0.00000/  
      DATA E1UPLO/  
     $  0.23946,  0.29055,  0.09778,  0.02149,  0.00344,  0.00050,  
     $  0.01751, -0.00609, -0.02687, -0.01916, -0.00797, -0.00275,  
     $ -0.00576, -0.00504,  0.00108,  0.00249,  0.00153,  0.00075,  
     $  0.00174,  0.00196,  0.00030, -0.00034, -0.00029, -0.00018,  
     $ -0.00053, -0.00064, -0.00017,  0.00004,  0.00006,  0.00004,  
     $  0.00017,  0.00022,  0.00008,  0.00001, -0.00001, -0.00001/  
      DATA E1DNLO/  
     $  0.12613,  0.13542,  0.03958,  0.00824,  0.00166,  0.00045,  
     $  0.00389, -0.01159, -0.01625, -0.00961, -0.00371, -0.00126,  
     $ -0.00191, -0.00056,  0.00159,  0.00159,  0.00084,  0.00039,  
     $  0.00064,  0.00049, -0.00015, -0.00029, -0.00018, -0.00010,  
     $ -0.00020, -0.00019,  0.00000,  0.00006,  0.00004,  0.00003,  
     $  0.00007,  0.00008,  0.00002, -0.00001, -0.00001, -0.00001/  
      DATA E1UBLO/  
     $  1.01386, -1.10585,  0.33739, -0.07444,  0.00885, -0.00087,  
     $  0.92334, -1.28541,  0.44755, -0.09786,  0.01419, -0.00112,  
     $  0.04888, -0.12708,  0.08606, -0.02608,  0.00478, -0.00060,  
     $ -0.02691,  0.04887, -0.01771,  0.00162,  0.00025, -0.00006,  
     $  0.00704, -0.01113,  0.00159,  0.00070, -0.00020,  0.00000,  
     $ -0.00171,  0.00229,  0.00038, -0.00035,  0.00004,  0.00001/  
      DATA E1GLLO/  
     $ 29.47734,-39.02468, 14.63570, -3.33516,  0.50538, -0.05915,  
     $ 25.58960,-39.54527, 16.61420, -4.29861,  0.69036, -0.08243,  
     $ -1.66291,  1.17624,  1.11844, -0.70986,  0.19481, -0.02404,  
     $ -0.21679,  0.81705, -0.71688,  0.18507, -0.01924, -0.00325,  
     $  0.20880, -0.43547,  0.22391, -0.02446, -0.00362,  0.00191,  
     $ -0.09097,  0.16009, -0.05681, -0.00250,  0.00258, -0.00047/  
      DATA E1STLO/  
     $  0.92351, -1.08483,  0.34642, -0.07210,  0.00914, -0.00091,  
     $  0.93146, -1.27376,  0.45122, -0.09775,  0.01380, -0.00131,  
     $  0.04739, -0.12960,  0.08482, -0.02642,  0.00476, -0.00057,  
     $ -0.02653,  0.04953, -0.01735,  0.00175,  0.00028, -0.00006,  
     $  0.00694, -0.01132,  0.00148,  0.00065, -0.00021,  0.00000,  
     $ -0.00168,  0.00234,  0.00042, -0.00034,  0.00005,  0.00001/  
      DATA E1CHLO/  
     $  0.80983, -1.04168,  0.33980, -0.06824,  0.00876, -0.00090,  
     $  0.89606, -1.21708,  0.43386, -0.09287,  0.01304, -0.00129,  
     $  0.03058, -0.10402,  0.07604, -0.02415,  0.00460, -0.00050,  
     $ -0.02451,  0.04432, -0.01651,  0.00143,  0.00012, -0.00010,  
     $  0.01122, -0.01457,  0.00268,  0.00058, -0.00012,  0.00003,  
     $ -0.00773,  0.00733, -0.00076, -0.00024,  0.00001,  0.00000/  
      DATA E1BTLO/  
     $  0.80288, -1.07532,  0.37920, -0.07843,  0.01007, -0.00109,  
     $  0.79033, -1.09887,  0.41532, -0.09301,  0.01317, -0.00141,  
     $ -0.01704, -0.01130,  0.02882, -0.01341,  0.00304, -0.00036,  
     $ -0.00072,  0.00723, -0.00516,  0.00108, -0.00005, -0.00004,  
     $  0.00305, -0.00461,  0.00166, -0.00013, -0.00001,  0.00001,  
     $ -0.00436,  0.00523, -0.00161,  0.00020, -0.00002,  0.00000/  
      DATA E1TPLO/  
     $  0.66233, -0.92481,  0.35193, -0.07930,  0.01110, -0.00118,  
     $  0.63797, -0.90619,  0.35816, -0.08479,  0.01265, -0.00139,  
     $ -0.02581,  0.02125,  0.00419, -0.00498,  0.00149, -0.00021,  
     $  0.00071,  0.00053, -0.00127,  0.00039, -0.00005, -0.00001,  
     $  0.00385, -0.00506,  0.00186, -0.00035,  0.00004,  0.00000,  
     $ -0.00353,  0.00446, -0.00150,  0.00027, -0.00003,  0.00000/  
C          E1POW GIVES POWERS OF (1-X). 
C          IE1FIT POINTS TO FIT FOR EACH VALUE OF IQ.   
      DATA E1POW/3.,4.,7.,5.,7.,7.,7.,7./   
      DATA IE1FIT/4,1,3,2,3,5,5,6,6,7,7,8,8/    
C          MINIMUM VALUE FOR STRUC  
      DATA SFMIN/1.E-10/    
C   
      BETA(W1,W2)=GAMMA(W1)*GAMMA(W2)/GAMMA(W1+W2)  
C          CHEBYSHEV POLYNOMIALS    
      CHEB1(X)=X    
      CHEB2(X)=2.*X**2-1.   
      CHEB3(X)=X*(-3.+4.*X**2)  
      CHEB4(X)=1.+X**2*(-8.+8.*X**2)    
      CHEB5(X)=X*(5.+X**2*(-20.+16.*X**2))  
C          ENTRY -- CHECK FOR UNPHYSICAL X  
      IF(X.LE.0..OR.X.GE..9999) THEN    
        STRUC=0.    
        GO TO 9999  
      ENDIF 
C          DETERMINE QUARK TYPE IIQ FOR PROTON  
      IIQ=IQ    
      IF(IQ.EQ.1) GO TO 120 
      IF(IH.EQ.1120) GO TO 120  
      IF(IH.EQ.-1120) GO TO 110 
C           SWAP UP AND DOWN QUARKS.    
      IF(IQ.EQ.2.OR.IQ.EQ.3) IIQ=IQ+2   
      IF(IQ.EQ.4.OR.IQ.EQ.5) IIQ=IQ-2   
110   CONTINUE  
      IF(IH.EQ.1220) GO TO 120  
C          SWAP QUARKS AND ANTIQUARKS   
      IIQ=IQ-1  
      IF(IQ.EQ.2*(IQ/2))IIQ=IQ+1    
120   CONTINUE  
C   
C          SELECT STRUCTURE FUNCTION FIT.   
C          OWENS-REYA AND BAIER ET AL. HAVE BEEN DELETED.   
      IF(ISTRUC.EQ.3) GO TO 1000    
      IF(ISTRUC.EQ.4) GO TO 2000    
      STRUC=0.  
      GO TO 9999    
C   
C          CALCULATE EICHTEN ETAL STRUC FCN FOR TYPE IIQ    
1000  STRUC=0.  
      Q2=QSQ    
      IF(Q2.LT.5.) Q2=5.    
      T=ALOG(Q2/ALAM2)  
      TMAX=ALOG(1.E8/ALAM2) 
      IF(IIQ.GT.9) GO TO 1001   
      Q2MIN=5.  
      GO TO 1002    
1001  AMQ=AMASS(IIQ/2)  
      Q2MIN=4.*AMQ**2/(1.-X)    
      IF(Q2.LT.Q2MIN) GO TO 9999    
1002  TMIN=ALOG(Q2MIN/ALAM2)    
      T1=(2.*T-(TMAX+TMIN))/(TMAX-TMIN) 
      CHEBQ(1)=1.   
      CHEBQ(2)=CHEB1(T1)    
      CHEBQ(3)=CHEB2(T1)    
      CHEBQ(4)=CHEB3(T1)    
      CHEBQ(5)=CHEB4(T1)    
      CHEBQ(6)=CHEB5(T1)    
C          X.GT.0.1 
      IF(X.LT.0.1) GO TO 1010   
      X1=(2.*X-1.1)/.9  
      ISHFT=0   
      GO TO 1020    
C          X.LT.0.1 
1010  X1=(2.*ALOG(X)+11.51293)/6.90776  
      ISHFT=8   
C          IFIT IS POINTER FOR EICHTEN QUARK TYPE.  
C          IFIT2 IS POINTER FOR FUNCTION -- SHIFTED BY 8 FOR X<0.1  
1020  IFIT=IE1FIT(IIQ)  
      IFIT2=IFIT+ISHFT  
      CHEBX(1)=1.   
      CHEBX(2)=CHEB1(X1)    
      CHEBX(3)=CHEB2(X1)    
      CHEBX(4)=CHEB3(X1)    
      CHEBX(5)=CHEB4(X1)    
      CHEBX(6)=CHEB5(X1)    
      TERM=0.   
      DO 1030 JQ=1,6    
      DO 1030 JX=1,6    
1030  TERM=TERM+E1STRC(JX,JQ,IFIT2)*CHEBQ(JQ)*CHEBX(JX) 
      TERM=TERM*(1.-X)**E1POW(IFIT) 
      STRUC=ABS(TERM)   
      IF(IFIT.GT.2) GO TO 9999  
C          ADD SEA TERM FOR VALENCE QUARKS  
      TERM=0.   
      DO 1040 JQ=1,6    
      DO 1040 JX=1,6    
1040  TERM=TERM+E1STRC(JX,JQ,3+ISHFT)*CHEBQ(JQ)*CHEBX(JX)   
      TERM=TERM*(1.-X)**E1POW(3)    
      STRUC=STRUC+ABS(TERM) 
      GO TO 9999    
C   
C          CALCULATE DUKE-OWENS STRUCTURE FUNCTION FOR TYPE IIQ.    
2000  STRUC=0.  
      Q2=QSQ    
      IF(Q2.LT.4.) Q2=4.    
      S=ALOG(ALOG(Q2/ALAM2)/ALOG(4./ALAM2)) 
      SS=S*S    
C          X*F(X) FOR GL    
      IF(IIQ.EQ.1) THEN 
        A0=1.56-1.71*S+.638*SS  
        A1=-0.949*S+.325*SS 
        B1=6.+1.44*S-1.05*SS    
        A2=9.-7.19*S+.255*SS    
        B2=-16.5*S+10.9*SS  
        C2=15.3*S-10.1*SS   
        STRUC=A0*X**A1*(1.-X)**B1*(1.+A2*X+B2*X**2+C2*X**3) 
C          X*F(X) FOR UP,UB,DN,DB,ST,SB 
      ELSEIF(IIQ.LE.7) THEN 
        A0=1.265-1.132*S+.293*SS    
        A1=-.372*S-.029*SS  
        B1=8.05+1.59*S-.153*SS  
        A2=6.31*S-.273*SS   
        B2=-10.5*S-3.17*SS  
        C2=14.7*S+9.80*SS   
        STRUC=A0*X**A1*(1.-X)**B1*(1.+A2*X+B2*X**2+C2*X**3)/6.  
        IF(IIQ.EQ.2.OR.IIQ.EQ.4) THEN   
          ETA1=.419+.004*S-.007*SS  
          ETA2=3.46+.724*S-.066*SS  
          GUD=4.40-4.86*S+1.33*SS   
          ETA3=.763-.237*S+.026*SS  
          ETA4=4.00+.627*S-.019*SS  
          GD=-.421*S+.033*SS    
          AUD=3./(BETA(ETA1,ETA2+1.)*(1.+GUD*ETA1/(ETA1+ETA2+1.)))  
          FUD=AUD*X**ETA1*(1.-X)**ETA2*(1.+GUD*X)   
          AD=1./(BETA(ETA3,ETA4+1.)*(1.+GD*ETA3/(ETA3+ETA4+1.)))    
          FD=AD*X**ETA3*(1.-X)**ETA4*(1.+GD*X)  
          IF(IIQ.EQ.2) STRUC=STRUC+FUD-FD   
          IF(IIQ.EQ.4) STRUC=STRUC+FD   
        ENDIF   
C          X*F(X) FOR CH,CB 
      ELSEIF(IIQ.LE.9) THEN 
        A0=.135*S-.0075*SS  
        A1=-.036-.222*S-.058*SS 
        B1=6.35+3.26*S-.909*SS  
        A2=-3.03*S+1.50*SS  
        B2=17.4*S-11.3*SS   
        C2=-17.9*S+15.6*SS  
        STRUC=A0*X**A1*(1.-X)**B1*(1.+A2*X+B2*X**2+C2*X**3) 
C          X*F(X)=0 FOR BT,BB,TP,TB 
      ELSE  
        STRUC=0.    
      ENDIF 
C          REQUIRE MINIMUM VALUE FOR STRUC  
9999  IF(STRUC.LT.SFMIN) STRUC=SFMIN    
      RETURN    
      END   

