#! /bin/csh -f
# -----------------------------------------------------------------------------
#
# Name       : fix_ps.csh
#
# Purpose    : Make postscript files generated by Powerpoint and Excel viewable
#              with ghostview
#
# Usage      : fix_ps.csh <ps-file>
#
# Options    : None
#
# Arguements : Postscript file
#
# Created    : 05-FEB-1997   Herb Greenlee
#
# Usage Note:
#
# 1.  The postscript file is converted in situ.  The original postscript
#     file is is renamed from <ps-file> to <ps-file>.old.
#
# -----------------------------------------------------------------------------
set file = $1
if ( ! -f "$file" ) then
  echo File '"'$file'"' not found
  exit 1
endif
set new_file = ${file}.new
set old_file = ${file}.old
nawk '/%%BeginSetup/,/%%EndSetup/{next}/%%EOF/{next}{print $0}' $file >! $new_file
if ( -f $new_file ) then
  mv -f $file $old_file
  mv    $new_file $file
endif

