      LOGICAL FUNCTION BOKTRD
C----------------------------------------------------------------------
C-
C-   Purpose and Methods : BOOK TRD HISTOGRAMMS
C-
C-   Inputs  : None
C-   Outputs : None
C-
C-   Created   8-JAN-1988   A. Zylberstejn
C-   Updated  14-JUL-1989   Harrison B. Prosper
C-   Made into pbd logical function
C-   Updated  20-OCT-1989   J. Schwindling  : Define histos for Cathodes
C-   Updated  22-APR-1991   A. Zylberstejn:  Use TRHIST to book or not the
C-                                        TRD histos (strd(7)=0: do not book)
C-   Updated  18-JUN-1993   J.P. Cussonneau  Add histos for Uranium
C-
C----------------------------------------------------------------------
      IMPLICIT NONE
      INCLUDE 'D0$INC:D0LOG.INC'
      INCLUDE 'D0$INC:TRINFO.INC'
C----------------------------------------------------------------------
      BOKTRD = .TRUE.
      TRHIST = STRD(7).EQ.1.
      IF (.NOT.TRHIST)   GO TO 999
      IF ( DCEN .LT. 2 ) GO TO 999
      IF ( DTRD .LT. 2 ) GO TO 999
C&IF SIUNIX,ULTRIX,IBMAIX,SUNOS,ALFOSF
C&      GO TO 999
C&ELSE
C
      CALL HBOOK1(7001,' GENERATED HADRON ENERGY PER TRACK$',
     +100,0.,100.,0.)
      CALL HBOOK1(7002,' GENERATED ELEC ENERGY PER TRACK$'
     +,100,0.,100.,0.)
      CALL HBOOK1(7003,' E TOT PER TRACK$',100,0.,200.,0.)
C total deposited energy per track per layer
      CALL HBOOK1(7101, ' DEPOSITED ENERGY IN LAYER 1 TRACK PION $'
     &  ,100,0.,200.,0.)
      CALL HBOOK1(7102, ' DEPOSITED ENERGY IN LAYER 2 TRACK PION $'
     &  ,100,0.,200.,0.)
      CALL HBOOK1(7103, ' DEPOSITED ENERGY IN LAYER 3 TRACK PION $'
     &  ,100,0.,200.,0.)
      CALL HBOOK1(7111, ' DEPOSITED ENERGY IN LAYER 1 TRACK ELEC $'
     &  ,100,0.,200.,0.)
      CALL HBOOK1(7112, ' DEPOSITED ENERGY IN LAYER 2 TRACK ELEC $'
     &  ,100,0.,200.,0.)
      CALL HBOOK1(7113, ' DEPOSITED ENERGY IN LAYER 3 TRACK ELEC $'
     &  ,100,0.,200.,0.)
C  TOTAL DEPOSITED ENERGY PER LAYER
      CALL HBOOK1(7017, ' DEPOSITED ENERGY IN LAYER 1$'
     &  ,100,0.,200.,0.)
      CALL HBOOK1(7018, ' DEPOSITED ENERGY IN LAYER 2$',100,0.,200.,0.)
      CALL HBOOK1(7019, ' DEPOSITED ENERGY IN LAYER 3$',100,0.,200.,0.)
      CALL HBOOK1(7300, ' LENGTH IN XENON$',50,2.2,6.,0.)
      CALL HBOOK1(7301, 'NB. OF X RAYS GENERATED$',12,-.5,11.5,0.)
      CALL HBOOK1(7302, 'NB. OF X RAYS SEEN$',12,-.5,11.5,0.)
      CALL HBOOK1(7303, 'X RAY CLUSTERS ENERGY GENERATED$'
     &  ,100,0.,30.,0.)
      CALL HBOOK1(7304, 'X RAY CLUSTERS ENERGY SEEN$',100,0.,30.,0.)
      CALL HBOOK1(7305, 'X RAY TOTAL ENERGY GENERATED$',100,0.,100.,0.)
      CALL HBOOK1(7306, 'X RAY TOTAL ENERGY SEEN$',100,0.,100.,0.)
      CALL HBOOK1(7307, ' LENGTH IN XENON DANS ENTRD ',50,2.2,6.,0.)
C  TOTAL DEPOSITED ENERGY PER SECTOR
      CALL HBOOK1(7020, ' DEPOSITED ENERGY PER SECTOR(16 WIRES)$',100,
     +0.,4100.,0.)
C
C      CALL HBOOK1(7051,' HITS VS. WIRE NUMBER: LAYER 1$',256,.5,256.5,0.)
C      CALL HBOOK1(7052,' HITS VS. WIRE NUMBER: LAYER 2$',256,.5,256.5,0.)
C      CALL HBOOK1(7053,' HITS VS. WIRE NUMBER: LAYER 3$',256,.5,256.5,0.)
C       CALL HBOOK1(7054,' Q VS. WIRE NUMBER$',256,.5,256.5,0.)
      CALL HBOOK1(7055,' ANODE DQ/DT LAYER 1',128,0.5,128.5,0.)
      CALL HBOOK1(7056,' ANODE DQ/DT LAYER 2',128,0.5,128.5,0.)
      CALL HBOOK1(7057,' ANODE DQ/DT LAYER 3',128,0.5,128.5,0.)
      CALL HBOOK1(7255,' CATHODE DQ/DT LAYER 1',128,0.5,128.5,0.)
      CALL HBOOK1(7256,' CATHODE DQ/DT LAYER 2',128,0.5,128.5,0.)
      CALL HBOOK1(7257,' CATHODE DQ/DT LAYER 3',128,0.5,128.5,0.)
      CALL HBOOK1(7053,' ENERGY FROM DEDT$',100,0.,200.,0.)
      CALL HBOOK1(7058,' SUMM OF FADC  $',100,0.,5000.,0.)
      CALL HBOOK1(7061,' SUMM OF ENERGY FROM FADC LAYER 1'
     &  ,100,0.,200.,0.)
      CALL HBOOK1(7062,' SUMM OF ENERGY FROM FADC LAYER 2'
     &  ,100,0.,200.,0.)
      CALL HBOOK1(7063,' SUMM OF ENERGY FROM FADC LAYER 3'
     &  ,100,0.,200.,0.)
C
C      CALL HBOOK1(7004,' COMPUTER TIME / LAYER / PRIMARY TRACK$',50
C     +,0.,1.,0.)
C      CALL HBOOK1(7005,' COMPUTER TIME / LAYER / SECONDARY TRACK$',50
C     +,0.,1.,0.)
C      CALL HBOOK1(7006,' NB. OF HIT WIRES FOR PRIMARY TRACKS$',11,-.5,
C     +10.5,0.)
C      CALL HBOOK1(7007,' NB. OF HIT WIRES FOR SECONDARY TRACKS$',11,-.5,
C     +10.5,0.)
C  NB. OF HIT WIRES PER LAYER
C      CALL HBOOK1(7008,' NB. OF HIT WIRES PER EVENT LAYER 1$',100,0.,
C     +100.,0.)
C      CALL HBOOK1(7009,' NB. OF HIT WIRES PER EVENT LAYER 2$',100,0.,
C     +100.,0.)
C      CALL HBOOK1(7010,' NB. OF HIT WIRES PER EVENT LAYER 3$',100,0.,
C     +100.,0.)
C  NB. OF TRACKS  PER WIRE
C      CALL HBOOK1(7011,' NB. OF TRACKS PER WIRE LAYER 1$',12,0.,12.,0.)
C      CALL HBOOK1(7012,' NB. OF TRACKS PER WIRE LAYER 2$',12,0.,12.,0.)
C      CALL HBOOK1(7013,' NB. OF TRACKS PER WIRE LAYER 3$',12,0.,12.,0.)
C  ENERGY PER WIRE
      CALL HBOOK1(7014,' DEPOSITED ENERGY PER WIRE LAYER 1$',100,0.
     +,100.,0.,0.)
      CALL HBOOK1(7015,' DEPOSITED ENERGY PER WIRE LAYER 2$',100,0.
     +,100.,0.,0.)
      CALL HBOOK1(7016,' DEPOSITED ENERGY PER WIRE LAYER 3$',100,0.
     +,100.,0.,0.)
C      CALL HBOOK1(7206,' NB. OF HIT STRIPS FOR PRIMARY TRACKS$',21,-.5,
C     +20.5,0.)
C      CALL HBOOK1(7207,' NB. OF HIT STRIPS FOR SECONDARY TRACKS$',
C     +21,-.5,20.5,0.)
C      CALL HBOOK1(7208,' NB. OF HIT STRIPS PER EVENT LAYER 1$',100,0.,
C     +300.,0.)
C      CALL HBOOK1(7209,' NB. OF HIT STRIPS PER EVENT LAYER 2$',100,0.,
C     +300.,0.)
C      CALL HBOOK1(7210,' NB. OF HIT STRIPS PER EVENT LAYER 3$',100,0.,
C     +300.,0.)
C      CALL HBOOK1(7211,' NB. OF TRACKS PER HIT STRIP LAYER 1$',20,
C     +0.,20.,0.)
C      CALL HBOOK1(7212,' NB. OF TRACKS PER HIT STRIP LAYER 2$',20,
C     +0.,20.,0.)
C      CALL HBOOK1(7213,' NB. OF TRACKS PER HIT STRIP LAYER 3$',20,
C     +0.,20.,0.)
C
C      CALL HBOOK1(7251,' HITS VS. STRIP NUMBER: LAYER 1$',256,.5,256.5,0.)
C      CALL HBOOK1(7252,' HITS VS. STRIP NUMBER: LAYER 2$',256,.5,256.5,0.)
C      CALL HBOOK1(7253,' HITS VS. STRIP NUMBER: LAYER 3$',256,.5,256.5,0.)
C      CALL HBOOK1(7254,' Q VS. STRIP NUMBER: LAYER 1$',256,.5,256.5,0.)
C      CALL HBOOK1(7255,' Q VS. STRIP NUMBER: LAYER 2$',256,.5,256.5,0.)
C      CALL HBOOK1(7256,' Q VS. STRIP NUMBER: LAYER 3$',256,.5,256.5,0.)
C      CALL HBOOK1(7257,' DQ/DT STRIPS LAYER 1$',120,.5,120.5,0.)
C      CALL HBOOK1(7258,' DQ/DT STRIPS LAYER 2$',120,.5,120.5,0.)
C      CALL HBOOK1(7259,' DQ/DT STRIPS LAYER 3$',120,.5,120.5,0.)
      IF(STRD(2).NE.1)THEN
      CALL HBOOK1(7401,' TOTAL ENERGY ON CATHODES CH1$',50,0.,5.,0.)
      CALL HBOOK1(7402,' TOTAL ENERGY ON CATHODES CH2$',50,0.,5.,0.)
      CALL HBOOK1(7403,' TOTAL ENERGY ON CATHODES CH3$',50,0.,5.,0.)
      CALL HBOOK1(7411,' ENERGY ON CATHODE 1 CH1$',100,0.,0.01,0.)
      CALL HBOOK1(7412,' ENERGY ON CATHODE 2 CH1$',100,0.,1.,0.)
      CALL HBOOK1(7413,' ENERGY ON CATHODE 3 CH1$',100,0.,0.01,0.)
      CALL HBOOK1(7421,' ENERGY ON CATHODE 1 CH2$',100,0.,0.01,0.)
      CALL HBOOK1(7422,' ENERGY ON CATHODE 2 CH2$',100,0.,1.,0.)
      CALL HBOOK1(7423,' ENERGY ON CATHODE 3 CH2$',100,0.,0.01,0.)
      CALL HBOOK1(7431,' ENERGY ON CATHODE 1 CH3$',100,0.,0.01,0.)
      CALL HBOOK1(7432,' ENERGY ON CATHODE 2 CH3$',100,0.,1.,0.)
      CALL HBOOK1(7433,' ENERGY ON CATHODE 3 CH3$',100,0.,0.01,0.)
      CALL HBOOK1(7501,' CLUSTER ENERGY CH 1$',100,0.,10.,0.)
      CALL HBOOK1(7502,' CLUSTER ENERGY CH 2$',100,0.,10.,0.)
      CALL HBOOK1(7503,' CLUSTER ENERGY CH 3$',100,0.,10.,0.)
      CALL HBOOK1(7504,' CLUSTER ENERGY CH 1$',100,0.,5.,0.)
      CALL HBOOK1(7505,' CLUSTER ENERGY CH 2$',100,0.,5.,0.)
      CALL HBOOK1(7506,' CLUSTER ENERGY CH 3$',100,0.,5.,0.)
      CALL HBOOK1(5911,' WEIGHT ON CATHODE 1 CH1$',100,0.,0.1,0.)
      CALL HBOOK1(5912,' WEIGHT ON CATHODE 2 CH1$',100,0.,0.3,0.)
      CALL HBOOK1(5913,' WEIGHT ON CATHODE 3 CH1$',100,0.,0.1,0.)
      CALL HBOOK1(5921,' WEIGHT ON CATHODE 1 CH2$',100,0.,0.1,0.)
      CALL HBOOK1(5922,' WEIGHT ON CATHODE 2 CH2$',100,0.,0.3,0.)
      CALL HBOOK1(5923,' WEIGHT ON CATHODE 3 CH2$',100,0.,0.1,0.)
      CALL HBOOK1(5931,' WEIGHT ON CATHODE 1 CH3$',100,0.,0.1,0.)
      CALL HBOOK1(5932,' WEIGHT ON CATHODE 2 CH3$',100,0.,0.3,0.)
      CALL HBOOK1(5933,' WEIGHT ON CATHODE 3 CH3$',100,0.,0.1,0.)
      CALL HBOOK1(6998,' DSTRIP*100.',100,-50.,50.,0.)
      CALL HBOOK1(6999,' ENG CLUSTERS ENERGY',100,0.,1.,0.)
      CALL HBOOK1(8997,' EPSIL IN CLUDEL',100,0.,10.,0.)
      CALL HBOOK1(8998,' ENER IN CLUDEL',100,0.,1.,0.)
      CALL HBOOK1(8999,' ENER IN CLUDEL AFTER CALL TO CLSMEN'
     &           ,100,0.,1.,0.)
      CALL HBOOK1(9001,' HIT WIRE NUMBER IN DIGTRD LAYER #1'
     &           ,256,0.5,256.5,0.)
      CALL HBOOK1(9002,' HIT WIRE NUMBER IN DIGTRD LAYER #2'
     &           ,256,0.5,256.5,0.)
      CALL HBOOK1(9003,' HIT WIRE NUMBER IN DIGTRD LAYER #3'
     &           ,256,0.5,256.5,0.)
      CALL HBOOK1(9101,' HIT WIRE NUMBER IN DIGTRD URANIUM LAYER #1'
     &           ,256,0.5,256.5,0.)
      CALL HBOOK1(9102,' HIT WIRE NUMBER IN DIGTRD URANIUM LAYER #2'
     &           ,256,0.5,256.5,0.)
      CALL HBOOK1(9103,' HIT WIRE NUMBER IN DIGTRD URANIUM LAYER #3'
     &           ,256,0.5,256.5,0.)
      CALL HBOOK1(9201,' DQ/DT URANIUM LAYER #1'
     &           ,128,0.5,128.5,0.)
      CALL HBOOK1(9202,' DQ/DT URANIUM LAYER #2'
     &           ,128,0.5,128.5,0.)
      CALL HBOOK1(9203,' DQ/DT URANIUM LAYER #3'
     &           ,128,0.5,128.5,0.)
      CALL HBOOK1(9004,' HIT WIRE NUMBER IN DIGTRD LAYER #4'
     &           ,256,0.5,256.5,0.)
      CALL HBOOK1(9005,' HIT WIRE NUMBER IN DIGTRD LAYER #5'
     &           ,256,0.5,256.5,0.)
      CALL HBOOK1(9006,' HIT WIRE NUMBER IN DIGTRD LAYER #6'
     &           ,256,0.5,256.5,0.)
      CALL HBOOK1(9104,' HIT WIRE NUMBER IN DIGTRD URANIUM LAYER #4'
     &           ,256,0.5,256.5,0.)
      CALL HBOOK1(9105,' HIT WIRE NUMBER IN DIGTRD URANIUM LAYER #5'
     &           ,256,0.5,256.5,0.)
      CALL HBOOK1(9106,' HIT WIRE NUMBER IN DIGTRD URANIUM LAYER #6'
     &           ,256,0.5,256.5,0.)
      CALL HBOOK1(9204,' DQ/DT URANIUM LAYER #4'
     &           ,128,0.5,128.5,0.)
      CALL HBOOK1(9205,' DQ/DT URANIUM LAYER #5'
     &           ,128,0.5,128.5,0.)
      CALL HBOOK1(9206,' DQ/DT URANIUM LAYER #6'
     &           ,128,0.5,128.5,0.)
      CALL HBOOK1(9207,' EGENST-DESTEP '
     &           ,100,-100.,100.,0.)
      CALL HBOOK1(9208,' EGENST '
     &           ,100,0.,100.,0.)
      CALL HBOOK1(9209,' DESTEP '
     &           ,100,0.,100.,0.)

      END IF
C      CALL HBOOK1(7510,' CLUSTER ENERGY WHEN 2 WIRES HIT$',
C     >   100,0.,20.,0.)
C      CALL HBOOK1(7511,' CLUSTER PHI WHEN 2 WIRES HIT CH1$',
C     >    30,-0.03,0.03,0.)
C      CALL HBOOK1(7512,' CLUSTER PHI WHEN 2 WIRES HIT CH2$',
C     >    30,-0.03,0.03,0.)
C      CALL HBOOK1(7513,' CLUSTER PHI WHEN 2 WIRES HIT CH3$',
C     >    30,-0.03,0.03,0.)
C
C&ENDIF
  999 RETURN
      END

