C----------------------------------------------------------------------
C-
C-   Created   7-FEB-1994   Brent J. May
C-   Updated   7-NOV-1994   Andrew G. Brandt  Convert to CW
C-   Updated   1-SEP-1995   Bob Hirosky  Add new unpacked tower arrays
C-                                       Compress integer words
C-   Updated   8-NOV-1995  Andrew G. Brandt  Add CATE information
C-   Updated  24-JAN-1996   Bob Hirosky  add neg slice words 
C-   Updated  25-JAN-1996   Bob Hirosky  ADD MORE NEW SLICE WORDS 
C-   Updated  29-FEB-1996   Andrew G. Brandt add DO_FDCTRK
C-   Updated  14-MAR-1996   Andrew G. Brandt allow 1000 packed words (200 NEG)
C-
C-
C----------------------------------------------------------------------
      INTEGER NEMMAX, NHDMAX,EMCATDMAX,NEMCMAX,NEMIMAX,EMJMAX,EMBMAX
      INTEGER NETAMAX,NPOSMAX,NNEGMAX,NMORMAX,EMNEGMAX
      PARAMETER (NEMMAX=20)
      PARAMETER (NHDMAX=20)
      PARAMETER (EMNEGMAX=200)
      PARAMETER (EMCATDMAX=1000)
      PARAMETER (NEMCMAX = 10)
      PARAMETER (NEMIMAX = 32)
      PARAMETER (EMJMAX=1000)
      PARAMETER (EMBMAX=1000)
      PARAMETER (NETAMAX=16)
      PARAMETER (NPOSMAX=5)
      PARAMETER (NNEGMAX=5)
      PARAMETER (NMORMAX=16)
      REAL TOWER_MAX_ET,TOWER_MIN_ET
      PARAMETER (TOWER_MAX_ET = 131.0 ) 
      PARAMETER (TOWER_MIN_ET = -131.0 ) 
      LOGICAL DO_HOT_KILL,DO_FIXED_LIST,DO_BY_RUN,DO_WRITE_RUN_EVT,
     &  DO_EM_CATD,DO_HD_CATD,DO_PACKED_EM,DO_EM_CONE,DO_EM_DELTA_R,
     &  DO_EM_IETA_GAP,DO_EM_IETA_IN_GAP,DO_REMOVE_JETS_IN_GAP,
     &  DO_NEMEVT,DO_PACKED_EMJ,DO_PACKED_EMB,DO_TRACK,
     &  DO_L0HITS,DO_EM_ETABIN,DO_EMNEG_ETABIN,DO_EMNEG_MORBIN,
     &  DO_HDNEG_ETABIN,DO_HDNEG_MORBIN,DO_ENERGY_SLICES,DO_SAMULT,
     &  DO_FDCTRK,DO_FDCSEG
      CHARACTER*80 HOT_RUN_FILE,RUN_LIST_FILE
      REAL EM_ET_THRESHOLDS(NEMMAX),HD_ET_THRESHOLDS(NHDMAX)
      REAL EM_CONE_DR(NEMCMAX)
      REAL EM_DELTA_R_DR(NEMCMAX),REMOVE_JET_RADIUS(NEMCMAX)
      REAL HOT_SIGMA_CUT, GAP_CONE_RADIUS,REMOVE_JET_ET
      INTEGER TYPE(NEMIMAX)
      INTEGER NUM_PACKED_EM,NUM_PACKED_EMJ,NUM_PACKED_EMB
      INTEGER LOCUT, HICUT, EM_IETA_GAPS(NEMIMAX),MBIETA
      REAL GAP_NJETS_CUT,DELTA_ETA_C_CUT,ABS_ETA_BOOST_CUT,USER_CUT
C some CATE vars
      REAL EM_POS_THRESHOLDS(NPOSMAX),EM_NEG_THRESHOLDS(NNEGMAX)
      REAL HD_POS_THRESHOLDS(NPOSMAX),HD_NEG_THRESHOLDS(NNEGMAX)
      INTEGER CATDE,NUM_PACKED_NEG
      LOGICAL DO_PACKED_NEG,DO_EM_MORBIN,DO_HD_ETABIN,DO_HD_MORBIN
C
C GAP_SWITCH
C
      COMMON /GAP_SWITCH/
     &  DO_HOT_KILL,DO_FIXED_LIST,DO_BY_RUN,DO_WRITE_RUN_EVT,
     &  DO_EM_CATD,DO_HD_CATD,DO_PACKED_EM,DO_EM_CONE,DO_EM_DELTA_R,
     &  DO_EM_IETA_GAP,DO_EM_IETA_IN_GAP,
     &  DO_REMOVE_JETS_IN_GAP,
     &  HOT_RUN_FILE,RUN_LIST_FILE,
     &  EM_ET_THRESHOLDS,HD_ET_THRESHOLDS,EM_CONE_DR,
     &  EM_DELTA_R_DR,REMOVE_JET_RADIUS,EM_IETA_GAPS,
     &  HOT_SIGMA_CUT, GAP_CONE_RADIUS,REMOVE_JET_ET,
     &  TYPE,NUM_PACKED_EM,NUM_PACKED_EMJ,NUM_PACKED_EMB,
     &  LOCUT, HICUT,
     &  GAP_NJETS_CUT,DELTA_ETA_C_CUT,ABS_ETA_BOOST_CUT,USER_CUT,
     &  DO_TRACK,DO_NEMEVT,DO_PACKED_EMJ,DO_PACKED_EMB,
     &  DO_L0HITS,DO_EM_ETABIN,MBIETA,
     &  CATDE,EM_POS_THRESHOLDS,EM_NEG_THRESHOLDS,DO_PACKED_NEG,
     &  NUM_PACKED_NEG,DO_EM_MORBIN,HD_POS_THRESHOLDS,HD_NEG_THRESHOLDS,
     &  DO_HD_ETABIN,DO_HD_MORBIN,DO_EMNEG_ETABIN,DO_EMNEG_MORBIN,
     &  DO_HDNEG_ETABIN,DO_HDNEG_MORBIN,DO_ENERGY_SLICES,DO_SAMULT,
     &  DO_FDCTRK,DO_FDCSEG
C
C GAP_RUN
C
      INTEGER IL,IH
      INTEGER IELDR(NEMCMAX), IEHDR(NEMCMAX)
      COMMON/GAP_RUN/IL,IH,IELDR,IEHDR
C
C GAP_CATD_HEAD
C
      INTEGER IEL, IEH, NEM_RAW, NHD_RAW
      REAL ETA_BOOST, DELTA_ETA_C
C
      COMMON /GAP_CATD_HEAD/DELTA_ETA_C,ETA_BOOST,IEL,IEH,
     &                       NEM_RAW, NHD_RAW
C
      CHARACTER*255 GAP_CATD_HEAD_TAG
      DATA GAP_CATD_HEAD_TAG/'DETA_C:R,ETA_BOO:R,
     &  IETAL[-37,37]:I,IETAH[-37,37]:I,
     &     NEMRAW[0,8191]:I,NHDRAW[0,8191]:I'/

C
C GAP_CATD_NEM
C
      INTEGER NEM_CATD(NEMMAX),NEM_ET
C
      COMMON /GAP_CATD_NEM/NEM_ET,NEM_CATD
C
      CHARACTER*255 GAP_CATD_NEM_TAG
      DATA GAP_CATD_NEM_TAG/'NNEM[0,20],NEM(NNEM)[0,8191]:I'/
C
C GAP_CATD_EVT
C
      INTEGER NEM_EVT(6)
C
      COMMON /GAP_CATD_EVT/NEM_EVT
C
      CHARACTER*255 GAP_CATD_EVT_TAG
      DATA GAP_CATD_EVT_TAG/'NEVTA[0,8191]:I,NEVTH[0,8191]:I,
     &  NEVTJ1[0,8191]:I,NEVTJ2[0,8191]:I,
     &  NEVTBN[0,8191]:I,NEVTBS[0,8191]:I'/ ! nbeam, sbeam
C
C GAP_CATD_NHD
C
      INTEGER NHD_CATD(NHDMAX),NHD_ET
C
      COMMON /GAP_CATD_NHD/NHD_ET,NHD_CATD
C
      CHARACTER*255 GAP_CATD_NHD_TAG
      DATA GAP_CATD_NHD_TAG/'NNHD[0,20],NHD(NNHD)[0,8191]:I'/
C
C GAP_CATD_CONE
C
      INTEGER NEM_CONE(NEMCMAX),NEM_ACONE(NEMCMAX),NEM_CONE_DR
C
      COMMON /GAP_CATD_CONE/NEM_CONE_DR,NEM_CONE,NEM_ACONE
C
      CHARACTER*255 GAP_CATD_CONE_TAG
      DATA GAP_CATD_CONE_TAG/'NNEMC[0,10],NEMC(NNEMC)[0,8191]:I,
     &                        NEMAC(NNEMC)[0,8191]:I'/
C
C GAP_CATD_DR
C
      INTEGER NEM_DELTA_R(NEMCMAX),NEM_DELTA_R_DR
C
      COMMON /GAP_CATD_DR/NEM_DELTA_R_DR,NEM_DELTA_R
C
      CHARACTER*255 GAP_CATD_DR_TAG
      DATA GAP_CATD_DR_TAG/'NNEMR[0,10],NEMR(NNEMR)[0,8191]:I'/
C
C GAP_CATD_IETA
C
      INTEGER NEM_IETA(NEMIMAX),NEM_IETA_GAPS
C
      COMMON /GAP_CATD_IETA/NEM_IETA_GAPS,NEM_IETA
C
      CHARACTER*255 GAP_CATD_IETA_TAG
      DATA GAP_CATD_IETA_TAG/'NNEMI[0,32],NEMI(NNEMI)[0,8191]:I'/

C
C GAP_CATD_IETAG
C
      INTEGER NEM_IETAG(NEMIMAX)
C
      COMMON /GAP_CATD_IETAG/NEM_IETAG
C
      CHARACTER*255 GAP_CATD_IETAG_TAG
      DATA GAP_CATD_IETAG_TAG/'NEMG(NNEMI)[-1,8190]:I'/
C
C GAP_CATD_REMJ
C
      INTEGER NEM_JET(NEMCMAX),NEM_JALL(NEMCMAX),NEM_REMOVE_DR
C
      COMMON /GAP_CATD_REMJ/NEM_REMOVE_DR,NEM_JET,NEM_JALL
C
      CHARACTER*255 GAP_CATD_REMJ_TAG
      DATA GAP_CATD_REMJ_TAG/'NNEMJ[0,10],NEMJ(NNEMJ)[-1,8190]:I,
     &                        NEMAJ(NNEMJ)[-1,8190]:I'/
C
C GAP_CATD_EM
C
      INTEGER EM_BTWN_ETA(EMCATDMAX),NPKEM
      INTEGER EM_BTWN_PHI(EMCATDMAX)
      REAL EM_BTWN_ET(EMCATDMAX)
C
      COMMON /GAP_CATD_EM/NPKEM,EM_BTWN_ETA,EM_BTWN_PHI,EM_BTWN_ET
C
      CHARACTER*255 GAP_CATD_EM_TAG
      DATA GAP_CATD_EM_TAG/'NPKEM[0,1000],EM_ETA(NPKEM)[-37,37]:I,
     &  EM_PHI(NPKEM)[1,64]:I,EM_ET(NPKEM):R:16:[0.0,131.0]'/
C
C GAP_CATD_EMJ
C
      INTEGER EM_JETS_ETA(EMJMAX),NPKEMJ
      INTEGER EM_JETS_PHI(EMJMAX)
      REAL EM_JETS_ET(EMJMAX)
C
      COMMON /GAP_CATD_EMJ/NPKEMJ,EM_JETS_ETA,EM_JETS_PHI,EM_JETS_ET
C
      CHARACTER*255 GAP_CATD_EMJ_TAG
      DATA GAP_CATD_EMJ_TAG/'NPKEMJ[0,1000],EMJ_ETA(NPKEMJ)[-37,37]:I,
     &  EMJ_PHI(NPKEMJ)[1,64]:I,EMJ_ET(NPKEMJ):R:16:[0.0,131.0]'/
C
C GAP_CATD_EMB
C
      INTEGER EM_BEAM_ETA(EMBMAX),NPKEMB
      INTEGER EM_BEAM_PHI(EMBMAX)
      REAL EM_BEAM_ET(EMBMAX)
C
      COMMON /GAP_CATD_EMB/NPKEMB,EM_BEAM_ETA,EM_BEAM_PHI,EM_BEAM_ET
C
      CHARACTER*255 GAP_CATD_EMB_TAG
      DATA GAP_CATD_EMB_TAG/'NPKEMB[0,1000],EMB_ETA(NPKEMB)[-37,37]:I,
     &  EMB_PHI(NPKEMB)[1,64]:I,EMB_ET(NPKEMB):R:16:[0.0,131.0]'/
C
C GAP_CATD_ETABIN
C
      INTEGER NBIN,NEM_ETABIN(NETAMAX)
C
      COMMON /GAP_CATD_ETABIN/NBIN,NEM_ETABIN
C
      CHARACTER*255 GAP_CATD_ETABIN_TAG
      DATA GAP_CATD_ETABIN_TAG/'NBIN[0,16],NEMBIN(NBIN)[0,1023]:I'/
C
C New CATE commons start here
C
C
C GAP_CATE_EVT
C
      INTEGER NEMPOS(NPOSMAX),NEMNEG(NNEGMAX),NEM_POS,NEM_NEG
C
      COMMON /GAP_CATE_EVT/NEM_POS,NEMPOS,NEM_NEG,NEMNEG
C
      CHARACTER*255 GAP_CATE_EVT_TAG
      DATA GAP_CATE_EVT_TAG/'NEM_POS[0,5],NEMPOS(NEM_POS)[0,8191]:I,
     &  NEM_NEG[0,5],NEMNEG(NEM_NEG)[0,8191]:I'/
C
C GAP_CATE_NEG
C
      INTEGER EM_NEG_ETA(EMNEGMAX),NPKNEG
      INTEGER EM_NEG_PHI(EMNEGMAX)
      REAL EM_NEG_ET(EMNEGMAX)
C
      COMMON /GAP_CATE_NEG/NPKNEG,EM_NEG_ETA,EM_NEG_PHI,EM_NEG_ET
C
      CHARACTER*255 GAP_CATE_NEG_TAG
      DATA GAP_CATE_NEG_TAG/'NPKNEG[0,200],NEG_ETA(NPKNEG)[-37,37]:I,
     &  NEG_PHI(NPKNEG)[1,64]:I,NEG_ET(NPKNEG):R:16:[-131.0,0.0]'/
C
C GAP_CATE_EMMOR
C
      INTEGER NMORB,NEM_BINTH2(NMORMAX),NEM_BINTH3(NMORMAX)
C
      COMMON /GAP_CATE_EMMOR/NMORB,NEM_BINTH2,NEM_BINTH3
C
      CHARACTER*255 GAP_CATE_EMMOR_TAG
      DATA GAP_CATE_EMMOR_TAG/'NMORB[0,16],NEMTH2(NMORB)[0,1023]:I,
     &                          NEMTH3(NMORB)[0,1023]:I'/
C
C GAP_CATE_EMNEGBIN
C
      INTEGER NNEGB, NEMNEG_ETABIN(NETAMAX)
C
      COMMON /GAP_CATE_EMNEGBIN/NNEGB,NEMNEG_ETABIN
C
      CHARACTER*255 GAP_CATE_EMNEGBIN_TAG
      DATA GAP_CATE_EMNEGBIN_TAG/'NNEGB[0,16],
     &  NEMNEGBIN(NNEGB)[0,1023]:I'/
C
C GAP_CATE_EMNEGMOR
C
      INTEGER NNEGMOR,NEMNEG_BINTH2(NMORMAX),NEMNEG_BINTH3(NMORMAX)
C
      COMMON /GAP_CATE_EMNEGMOR/NNEGMOR,NEMNEG_BINTH2,NEMNEG_BINTH3
C
      CHARACTER*255 GAP_CATE_EMNEGMOR_TAG
      DATA GAP_CATE_EMNEGMOR_TAG/'NNEGMOR[0,16],
     &  NEMNEGTH2(NNEGMOR)[0,1023]:I,NEMNEGTH3(NNEGMOR)[0,1023]:I'/
C
C GAP_CATE_HD
C
      INTEGER NHDPOS(NPOSMAX),NHDNEG(NNEGMAX),NHD_POS,NHD_NEG
C
      COMMON /GAP_CATE_HD/NHD_POS,NHDPOS,NHD_NEG,NHDNEG
C
      CHARACTER*255 GAP_CATE_HD_TAG
      DATA GAP_CATE_HD_TAG/'NHD_POS[0,5],NHDPOS(NHD_POS)[0,8191]:I,
     &  NHD_NEG[0,5],NHDNEG(NHD_NEG)[0,8191]:I'/
C
C GAP_CATE_HDBIN
C
      INTEGER NHDBIN,NHD_ETABIN(NMORMAX)
C
      COMMON /GAP_CATE_HDBIN/NHDBIN,NHD_ETABIN
C
      CHARACTER*255 GAP_CATE_HDBIN_TAG
      DATA GAP_CATE_HDBIN_TAG/'NHD_BIN[0,16],NHDBIN(NHD_BIN)[0,1023]:I'/
C
C GAP_CATE_HDMOR
C
      INTEGER NHDMOR,NHD_BINTH2(NMORMAX),NHD_BINTH3(NMORMAX)
C
      COMMON /GAP_CATE_HDMOR/NHDMOR,NHD_BINTH2,NHD_BINTH3
C
      CHARACTER*255 GAP_CATE_HDMOR_TAG
      DATA GAP_CATE_HDMOR_TAG/'NHDMOR[0,16],NHDTH2(NHDMOR)[0,1023]:I,
     &                          NHDTH3(NHDMOR)[0,1023]:I'/
C
C GAP_CATE_HDNEGBIN
C
      INTEGER NHDNEGB, NHDNEG_ETABIN(NETAMAX)
C
      COMMON /GAP_CATE_HDNEGBIN/NHDNEGB,NHDNEG_ETABIN
C
      CHARACTER*255 GAP_CATE_HDNEGBIN_TAG
      DATA GAP_CATE_HDNEGBIN_TAG/'NHDNEGB[0,16],
     &  NHDNEGBIN(NHDNEGB)[0,1023]:I'/
C
C GAP_CATE_HDNEGMOR
C
      INTEGER NHDNEGMOR,NHDNEG_BINTH2(NMORMAX),NHDNEG_BINTH3(NMORMAX)
C
      COMMON /GAP_CATE_HDNEGMOR/NHDNEGMOR,NHDNEG_BINTH2,NHDNEG_BINTH3
C
      CHARACTER*255 GAP_CATE_HDNEGMOR_TAG
      DATA GAP_CATE_HDNEGMOR_TAG/'NHDNEGMR[0,16],
     &  NHDNEGTH2(NHDNEGMR)[0,1023]:I,NHDNEGTH3(NHDNEGMR)[0,1023]:I'/
C
C GAP_CATE_ESLICE
C
      REAL E_NEG, E_NEGB(NETAMAX), E_NEG1, E_NEG1B(NETAMAX),
     &  E_POS, E_POSB(NETAMAX), E_POS1, E_POS1B(NETAMAX)
C
      COMMON /GAP_CATE_ESLICE/E_NEG,E_NEG1,E_POS,E_POS1,
     &  E_NEGB,E_NEG1B,E_POSB,E_POS1B
C
      CHARACTER*255 GAP_CATE_ESLICE_TAG
      DATA GAP_CATE_ESLICE_TAG/'E_NEG:R,E_NEG1:R,E_POS:R,E_POS1:R,
     &  E_NEGB(16):R,E_NEG1B(16):R,E_POSB(16):R,E_POS1B(16):R'/
C
C GAP_CATE_HSLICE
C
      REAL H_NEG, H_NEGB(NETAMAX), H_NEG1, H_NEG1B(NETAMAX),
     &  H_POS, H_POSB(NETAMAX), H_POS1, H_POS1B(NETAMAX)
C
      COMMON /GAP_CATE_HSLICE/H_NEG,H_NEG1,H_POS,H_POS1,
     &  H_NEGB,H_NEG1B,H_POSB,H_POS1B
C
      CHARACTER*255 GAP_CATE_HSLICE_TAG
      DATA GAP_CATE_HSLICE_TAG/'H_NEG:R,H_NEG1:R,H_POS:R,H_POS1:R,
     &  H_NEGB(16):R,H_NEG1B(16):R,H_POSB(16):R,H_POS1B(16):R'/
